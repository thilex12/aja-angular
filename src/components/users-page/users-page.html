<app-layout>
    <div class="users-container">
        <div class="users-header">
            <h1 class="page-title">Utilisateurs</h1>
        </div>
        <form #myForm="ngForm" (ngSubmit)="onSubmit(myForm)">
            <mat-form-field appearance="fill">
                <mat-label>Recherche</mat-label>
                <input matInput placeholder="Champ de recherche" name="searchField" ngModel #searchField="ngModel" />
            </mat-form-field>
            <button matButton type="submit" [disabled]="!myForm.form.valid" >Rechercher</button>
        </form>
            <p class="users-count">{{users().length}} utilisateur(s)</p>
        <div class="users-grid">
            @for (user of users(); track user.id) {
                <mat-card class="user-card" appearance="outlined" (click)="getUserDetails(user.id)">
                    <div class="user-header">
                        <div class="user-avatar">
                            <mat-icon>person</mat-icon>
                        </div>
                        <div class="user-info">
                            <h2 class="user-name">{{user.name}} {{user.surname}}</h2>
                            <p class="user-id">ID: {{user.id}}</p> 
                        </div>
                    </div>
                    
                    <mat-card-content class="user-content">
                        @if (getUserSignal() && getUserSignal()!.id === user.id) {
                            <div class="user-details">
                                <div class="detail-section">
                                    <div class="detail-item">
                                        <mat-icon>email</mat-icon>
                                        <span>{{getUserSignal()!.mail}}</span>
                                    </div>
                                </div>
                                
                                @if (getUserSignal()!.followTags && getUserSignal()!.followTags.length > 0) {
                                    <div class="detail-section">
                                        <h3 class="section-title">
                                            <mat-icon>label</mat-icon>
                                            Tags suivis
                                        </h3>
                                        <div class="tags-list">
                                            @for (tag of getUserSignal()!.followTags; track tag) {
                                                <span class="tag-chip">{{tag.nameTag}}</span>
                                            }
                                        </div>
                                    </div>
                                }
                                
                                @if (getUserSignal()!.inscriptions && getUserSignal()!.inscriptions.length > 0) {
                                    <div class="detail-section">
                                        <h3 class="section-title">
                                            <mat-icon>event_available</mat-icon>
                                            Inscriptions
                                        </h3>
                                        <div class="inscriptions-list">
                                            @for (inscription of getUserSignal()!.inscriptions; track inscription.id) {
                                                <div class="inscription-item">
                                                    <mat-icon>chevron_right</mat-icon>
                                                    <span>{{getEventName(inscription.eventId)}}</span>
                                                </div>
                                            }
                                        </div>
                                    </div>
                                }
                            </div>
                        } @else {
                            <div class="click-hint">
                                <mat-icon>info</mat-icon>
                                <span>Cliquez pour voir les d√©tails</span>
                            </div>
                        }
                    </mat-card-content>
                </mat-card>
            }
        </div>
    </div>
    
    <button matFab (click)="openDialog()" class="button-add">
        <mat-icon>add</mat-icon>
    </button>
    
    <router-outlet/>
</app-layout>